generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Student {
  id           String   @id @default(cuid())
  name         String
  email        String   @unique
  studentId    String   @unique
  university   String
  class        String
  password     String
  role         String   @default("student")
  credits      Float    @default(100)
  points       Int      @default(0)
  isVerified   Boolean  @default(false)
  profilePhoto String?
  createdAt    DateTime @default(now())

  feedbacks           Feedback[]
  rewardRedemptions   RewardRedemption[]
  sentTransactions     CreditTransaction[] @relation("SentCredits")
  receivedTransactions CreditTransaction[] @relation("ReceivedCredits")
}

model Feedback {
  id         String   @id @default(cuid())
  studentId  String
  student    Student  @relation(fields: [studentId], references: [id])
  mealType   String
  wasteLevel String
  comments   String?
  mealDate   DateTime @default(now())
  mealTime   String?
  location   String?
  createdAt  DateTime @default(now())
}

model RewardRedemption {
  id         String   @id @default(cuid())
  studentId  String
  student    Student  @relation(fields: [studentId], references: [id])
  rewardName String
  pointsUsed Int
  createdAt  DateTime @default(now())
}

model CreditTransaction {
  id         String   @id @default(cuid())
  senderId   String
  sender     Student  @relation("SentCredits", fields: [senderId], references: [id])
  receiverId String
  receiver   Student  @relation("ReceivedCredits", fields: [receiverId], references: [id])
  amount     Float
  note       String?
  createdAt  DateTime @default(now())
}

model WasteData {
  id        String   @id @default(cuid())
  date      DateTime @unique
  wasteKg   Float
  mealsRescued Int
}
